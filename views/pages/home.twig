{% extends "../layouts/base.twig" %}

{% block main %}
	<div>
		<div>
			<div>
				<!-- Boîte de bienvenue -->
				<div>
					<div>
						<div>
							<h1>Bienvenue,
								{{ utilisateur.prenom }}
								{{ utilisateur.nom }}</h1>
							<div>
								<p>Vos points actuels :
									<span>{{ utilisateur.points }}</span>
								</p>
							</div>
							<div>
								<a href="/profil">Mon profil</a>
								{% if utilisateur.role == 'ADMIN' %}
									<a href="/admin">Accéder à l'administration</a>
								{% endif %}
								<form action="/home/deconnexion" method="POST">
									<button type="submit">Déconnexion</button>
								</form>
								<a href="/mes-paris">Mes Paris</a>
							</div>
						</div>
					</div>
				</div>

				<!-- Menu des jeux et compétitions -->
				<div>
					<div>
						<div>
							<h2>Jeux et Compétitions</h2>
							<ul id="jeux-list">
								{% for jeu in jeux %}
									<li>
										<a href="#" onclick="loadCompetitions({{ jeu.id }})">{{ jeu.nom }}</a>
										<ul id="competitions-{{ jeu.id }}" style="display: none;"></ul>
									</li>
								{% endfor %}
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- Section des matchs à venir -->
		<div>
			<div>
				<div>
					<h2>Matchs à venir</h2>
					<div id="matchs-container">
						{% if matchsAvenir is not empty %}
							<ul>
								{% for match in matchsAvenir %}
									<li>
										<h3>{{ match.equipe1.nom }}
											vs
											{{ match.equipe2.nom }}</h3>
										<p>Date :
											{{ match.date | date("d/m/Y") }}
											à
											{{ match.date | date("H:i") }}</p>
										<div>
											<button onclick="openBetModal({{ match.id }}, '{{ match.equipe1.nom }}', {{ utilisateur.points }})">Parier sur
												{{ match.equipe1.nom }}</button>
											<button onclick="openBetModal({{ match.id }}, '{{ match.equipe2.nom }}', {{ utilisateur.points }})">Parier sur
												{{ match.equipe2.nom }}</button>
										</div>
									</li>
								{% endfor %}
							</ul>

							<!-- Modale pour parier -->
							<div id="betModal" class="hidden fixed z-10 inset-0 overflow-y-auto">
								<div class="flex items-center justify-center min-h-screen">
									<div class="bg-white rounded-lg shadow-xl w-1/3">
										<div class="p-4">
											<h2 id="modalMatchTitle" class="text-lg font-bold mb-4">Pari</h2>
											<form action="/parier" method="POST">
												<p id="errorBet"></p>
												<input type="hidden" name="match_id" id="modalMatchId">
												<input type="hidden" name="equipe_choisie" id="modalEquipeChoisie">
												<label for="pointsMises" class="block mb-2">Points à parier :</label>
												<input type="number" name="points_mises" id="pointsMises" class="w-full border-gray-300 rounded-lg">
												<div class="flex justify-end mt-4">
													<button type="submit" class="bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700">Valider</button>
													<button type="button" onclick="closeBetModal()" class="ml-2 bg-gray-300 text-gray-700 py-2 px-4 rounded hover:bg-gray-400">Annuler</button>
												</div>
											</form>
										</div>
									</div>
								</div>
							</div>
						{% else %}
							<p>Aucun match à venir pour le moment.</p>
						{% endif %}
					</div>
				</div>
			</div>
		</div>

		<!-- Section des matchs passés -->
		<div>
			<div>
				<div>
					<h2>Matchs passés</h2>
					<div
						id="matchs-passes-container"><!-- Les matchs passés seront chargés ici par JavaScript -->
					</div>
				</div>
			</div>
		</div>
	</div>

{% endblock %}
{% block script %}
	<script src="/js/script.js"></script>
{% endblock %}
