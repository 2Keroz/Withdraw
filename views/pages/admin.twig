{% extends "../layouts/base.twig" %}

{% block style %}
<link href="/css/admin.css" rel="stylesheet">
{% endblock %}

{% block main %}
<main>
    <div id="left-column">
        <h2>Gestion</h2>
        <article class="create-view-buttons">
            <h3>Créer</h3>
            <a href="/admin/jeu/creer" class="button">Créer un Jeu</a>
            <a href="/admin/competition/creer" class="button">Créer une Compétition</a>
            <a href="/admin/equipe/creer" class="button">Créer une Équipe</a>
            <a href="/admin/match/creer" class="button">Créer un Match</a>
        </article>
        <article class="create-view-buttons">
            <h3>Voir</h3>
            <a href="/admin/jeux" class="button">Voir tous les Jeux</a>
            <a href="/admin/competitions" class="button">Voir toutes les Compétitions</a>
            <a href="/admin/equipes" class="button">Voir toutes les Équipes</a>
        </article>
    </div>

    <div id="right-column">
        <section>
            <h1>Gestion des utilisateurs</h1>
            <form action="/admin/utilisateurs/recherche" method="GET">
                <input type="text" name="query" placeholder="Rechercher par nom, prénom ou email" required>
                <button type="submit" class="button">Rechercher</button>
            </form>
            <div class="user-cards">
                {% for utilisateur in utilisateurs %}
                <div class="user-card">
                    <h2>{{ utilisateur.nom }} {{ utilisateur.prenom }}</h2>
                    <p><strong>Email:</strong> {{ utilisateur.email }}</p>
                    <p><strong>Points:</strong> {{ utilisateur.points }}</p>
                    <p><strong>Rôle:</strong> {{ utilisateur.role }}</p>
                    <div class="actions">
                        <a href="/admin/utilisateur/{{ utilisateur.id }}/modifier" class="button">Modifier</a>
                        <form action="/admin/utilisateur/{{ utilisateur.id }}/supprimer" method="POST">
                            <button type="submit" class="button">Supprimer</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
        <section>
            <h1>Gestion des matchs non clôturés</h1>
            <form action="/admin/matchs/non-clotures/recherche" method="GET">
                <input type="text" name="query" placeholder="Rechercher par équipe" required>
                <button type="submit" class="button">Rechercher</button>
            </form>
            <div class="match-cards">
                {% for match in matchsNonClotures %}
                <div class="match-card {% if match.date|date('U') <= 'now'|date('U') %}match-started{% endif %}">
                    <h2>Match #{{ match.id }}</h2>
                    <p><strong>Équipe 1:</strong> {{ match.equipe1.nom }}</p>
                    <p><strong>Équipe 2:</strong> {{ match.equipe2.nom }}</p>
                    <p><strong>Date:</strong> {{ match.date|date("d/m/Y H:i") }}</p>
                    <div class="actions">
                        <a href="/admin/match/{{ match.id }}/modifier" class="button">Modifier</a>
                        <a href="/admin/match/{{ match.id }}/supprimer" class="button">Supprimer</a>
                        {% if match.date|date('U') <= 'now'|date('U') %}
                        <a href="/admin/match/{{ match.id }}/cloturer" class="button">Clôturer</a>
                        {% endif %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
        <section>
            <h1>Gestion des matchs clôturés</h1>
            <form action="/admin/matchs/clotures/recherche" method="GET">
                <input type="text" name="query" placeholder="Rechercher par équipe" required>
                <button type="submit" class="button">Rechercher</button>
            </form>
            <div class="match-cards">
                {% for match in matchsClotures %}
                <div class="match-card">
                    <h2>Match #{{ match.id }}</h2>
                    <p><strong>Équipe 1:</strong> {{ match.equipe1.nom }}</p>
                    <p><strong>Équipe 2:</strong> {{ match.equipe2.nom }}</p>
                    <p><strong>Date:</strong> {{ match.date|date("d/m/Y H:i") }}</p>
                    <p><strong>Équipe Gagnante:</strong> {{ match.equipeGagnante.nom }}</p>
                    <div class="actions">
                        <form action="/admin/match/{{ match.id }}/supprimer" method="POST">
                            <button type="submit" class="button">Supprimer</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>
    </div>
</main>
{% endblock %}
